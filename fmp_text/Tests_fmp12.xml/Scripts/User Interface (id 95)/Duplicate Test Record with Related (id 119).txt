################################################################################
# PURPOSE:
#    Duplicate a parent record and all it's related records.
################################################################################
#
#
#
Freeze Window
Set Variable [ $relatedRecordsExist; Value:Count ( tes_TPR__TestParameter::id ) ]
#
#
#
# isolate related records on related tables layout
If [ $relatedRecordsExist ]
Go to Related Record [ From table: “tes_TPR__TestParameter”; Using layout: “TPA__TestParameter” (TPA__TestParameter) ][ Show only related records ]
End If
#
#
#
# duplicate parent record
Go to Layout [ original layout ]
Duplicate Record/Request
Set Field [ TES__Test::name; TES__Test::name & " Copy" ]
Set Variable [ $id; Value:TES__Test::id ]
#
#
#
# duplicate related records
If [ $relatedRecordsExist ]
Go to Layout [ “TPA__TestParameter” (TPA__TestParameter) ]
Unsort Records
Loop
Exit Loop If [ Get ( FoundCount ) = 0 ]
Go to Record/Request/Page[ First ]
Duplicate Record/Request
Set Field [ TPA__TestParameter::id_Test; $id ]
Commit Records/Requests[ No dialog ]
Omit Record
Go to Record/Request/Page[ First ]
Omit Record
End Loop
End If
#
#
#
#
Go to Layout [ original layout ]
#
#
#


---
Script:
  includeInMenu: 'False'
  runFullAccess: 'False'
  id: '119'
  name: Duplicate Test Record with Related
  StepList:
    Step:
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '################################################################################'
      Text: '###############################################################################'
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '# PURPOSE:'
      Text: ' PURPOSE:'
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '#    Duplicate a parent record and all it''s related records.'
      Text: '    Duplicate a parent record and all it''s related records.'
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '################################################################################'
      Text: '###############################################################################'
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '#'
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '#'
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '#'
    - enable: 'True'
      id: '79'
      name: Freeze Window
      StepText: Freeze Window
    - enable: 'True'
      id: '141'
      name: Set Variable
      StepText: Set Variable [ $relatedRecordsExist; Value:Count ( tes_TPR__TestParameter::id
        ) ]
      Value:
        Calculation: Count ( tes_TPR__TestParameter::id )
        DisplayCalculation:
          Chunk:
          - Count
          - ' ( '
          - type: FieldRef
            Field:
              table: tes_TPR__TestParameter
              id: '1'
              name: id
          - ' )'
      Repetition:
        Calculation: '1'
        DisplayCalculation:
          Chunk: '1'
      Name: $relatedRecordsExist
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '#'
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '#'
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '#'
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '# isolate related records on related tables layout'
      Text: ' isolate related records on related tables layout'
    - enable: 'True'
      id: '68'
      name: If
      StepText: If [ $relatedRecordsExist ]
      Calculation: $relatedRecordsExist
      DisplayCalculation:
        Chunk: $relatedRecordsExist
    - enable: 'True'
      id: '74'
      name: Go to Related Record
      StepText: |-
        Go to Related Record [ From table: “tes_TPR__TestParameter”; Using layout: “TPA__TestParameter” (TPA__TestParameter) ]
        [ Show only related records ]
      Option:
        state: 'False'
      MatchAllRecords:
        state: 'False'
      ShowInNewWindow:
        state: 'False'
      Restore:
        state: 'True'
      LayoutDestination:
        value: SelectedLayout
      NewWndStyles:
        Styles: '983554'
      Table:
        id: '1065098'
        name: tes_TPR__TestParameter
      Layout:
        id: '8'
        name: TPA__TestParameter
    - enable: 'True'
      id: '70'
      name: End If
      StepText: End If
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '#'
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '#'
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '#'
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '# duplicate parent record'
      Text: ' duplicate parent record'
    - enable: 'True'
      id: '6'
      name: Go to Layout
      StepText: Go to Layout [ original layout ]
      LayoutDestination:
        value: OriginalLayout
    - enable: 'True'
      id: '8'
      name: Duplicate Record/Request
      StepText: Duplicate Record/Request
    - enable: 'True'
      id: '76'
      name: Set Field
      StepText: Set Field [ TES__Test::name; TES__Test::name & " Copy" ]
      Calculation: TES__Test::name & " Copy"
      DisplayCalculation:
        Chunk:
        - type: FieldRef
          Field:
            table: TES__Test
            id: '6'
            name: name
        - ' & " Copy"'
      Field:
        table: TES__Test
        id: '6'
        name: name
    - enable: 'True'
      id: '141'
      name: Set Variable
      StepText: Set Variable [ $id; Value:TES__Test::id ]
      Value:
        Calculation: TES__Test::id
        DisplayCalculation:
          Chunk:
            type: FieldRef
            Field:
              table: TES__Test
              id: '1'
              name: id
      Repetition:
        Calculation: '1'
        DisplayCalculation:
          Chunk: '1'
      Name: $id
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '#'
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '#'
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '#'
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '# duplicate related records'
      Text: ' duplicate related records'
    - enable: 'True'
      id: '68'
      name: If
      StepText: If [ $relatedRecordsExist ]
      Calculation: $relatedRecordsExist
      DisplayCalculation:
        Chunk: $relatedRecordsExist
    - enable: 'True'
      id: '6'
      name: Go to Layout
      StepText: Go to Layout [ “TPA__TestParameter” (TPA__TestParameter) ]
      LayoutDestination:
        value: SelectedLayout
      Layout:
        id: '8'
        name: TPA__TestParameter
    - enable: 'True'
      id: '21'
      name: Unsort Records
      StepText: Unsort Records
    - enable: 'True'
      id: '71'
      name: Loop
      StepText: Loop
    - enable: 'True'
      id: '72'
      name: Exit Loop If
      StepText: Exit Loop If [ Get ( FoundCount ) = 0 ]
      Calculation: Get ( FoundCount ) = 0
      DisplayCalculation:
        Chunk:
        - Get
        - ' ( '
        - FoundCount
        - ' ) = 0'
    - enable: 'True'
      id: '16'
      name: Go to Record/Request/Page
      StepText: |-
        Go to Record/Request/Page
        [ First ]
      NoInteract:
        state: 'False'
      RowPageLocation:
        value: First
    - enable: 'True'
      id: '8'
      name: Duplicate Record/Request
      StepText: Duplicate Record/Request
    - enable: 'True'
      id: '76'
      name: Set Field
      StepText: Set Field [ TPA__TestParameter::id_Test; $id ]
      Calculation: $id
      DisplayCalculation:
        Chunk: $id
      Field:
        table: TPA__TestParameter
        id: '2'
        name: id_Test
    - enable: 'True'
      id: '75'
      name: Commit Records/Requests
      StepText: |-
        Commit Records/Requests
        [ No dialog ]
      NoInteract:
        state: 'True'
      Option:
        state: 'False'
      ESSForceCommit:
        state: 'False'
    - enable: 'True'
      id: '25'
      name: Omit Record
      StepText: Omit Record
    - enable: 'True'
      id: '16'
      name: Go to Record/Request/Page
      StepText: |-
        Go to Record/Request/Page
        [ First ]
      NoInteract:
        state: 'False'
      RowPageLocation:
        value: First
    - enable: 'True'
      id: '25'
      name: Omit Record
      StepText: Omit Record
    - enable: 'True'
      id: '73'
      name: End Loop
      StepText: End Loop
    - enable: 'True'
      id: '70'
      name: End If
      StepText: End If
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '#'
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '#'
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '#'
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '#'
    - enable: 'True'
      id: '6'
      name: Go to Layout
      StepText: Go to Layout [ original layout ]
      LayoutDestination:
        value: OriginalLayout
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '#'
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '#'
    - enable: 'True'
      id: '89'
      name: Comment
      StepText: '#'
